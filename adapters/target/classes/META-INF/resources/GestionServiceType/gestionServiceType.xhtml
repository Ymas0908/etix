<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml">

    <ui:define name="title">Gérer un service-type </ui:define>
    <ui:define name="viewname">
        <li>UTILISATION</li>
        <li>
            <i class="pi pi-chevron-right"></i>
        </li>
        <li>
            <p:link outcome="/GestionServiceType/gestionServiceType"> GESTION D'UN SERVICE-TYPE </p:link>
        </li>
    </ui:define>
    <ui:define name="content">
        <h:form id="serviceTypeForm">
            <div class="grid">
                <div class="col-12">
                    <div class="card">
                        <h3 class="font-bold mb-4">Gestion des services-type et web</h3>
                        <div class="flex my-4">
                            <div class="flex-1 flex flex-column">
                                <h5>Liste des services-type (#{gestionUnServiceTypeMB.serviceTypes.size()})
                                </h5>
                            </div>
                            <div class="flex align-items-center justify-content-center">
                                <p:commandButton icon="pi pi-plus" process="@this"
                                                 value="Créer un service-type" styleClass="w-auto"
                                                 onclick="PF('editerServiceTypeSidebar').show()"/>
                            </div>
                        </div>
                        <div class="grid">
                            <div class="col-12">
                                <p:dataTable widgetVar="wServiceType"
                                             var="serviceType"
                                             value="#{gestionUnServiceTypeMB.serviceTypes}"
                                             reflow="true"
                                             emptyMessage="Pas de données"
                                             rowKey="#{serviceType.ID}"
                                             scrollable="true"
                                             scrollHeight="500">

                                    <p:column headerText="Libelle">
                                        <h:outputText value="#{serviceType.libelle}"/>
                                    </p:column>
                                    <p:column id="planCommissionTableTypeCommission" headerText="Age minimum">
                                        <h:outputText value="#{serviceType.ageMinimumLimite}"/>
                                    </p:column>
                                    <p:column id="planCommissionTableTypeStatut" headerText="Statut">
                                        <h:outputText value="#{serviceType.statutServiceType}"/>
                                    </p:column>

                                    <p:column headerText="Actions" width="10em">
                                        <p:commandButton icon="pi pi-pencil"
                                                         process="serviceTypeForm"
                                                         update="tabViewServiceTypeWeb"
                                                         title="Modifier"
                                                         styleClass="rounded-button ui-button mr-1"
                                                         action="#{gestionUnServiceTypeMB.selectServiceType()}">
                                            <f:setPropertyActionListener value="#{serviceType}"
                                                                         target="#{gestionUnServiceTypeMB.serviceType}"/>
                                        </p:commandButton>
                                        <p:commandButton icon="pi pi-lock"
                                                         process="serviceTypeForm"
                                                         update="activateServiceTypeSidebarForm"
                                                         title="Activer / Desactiver"
                                                         styleClass="rounded-button ui-button mr-1"
                                                         onclick="PF('activateServiceTypeSidebar').show()">
                                            <f:setPropertyActionListener value="#{serviceType}"
                                                                         target="#{gestionUnServiceTypeMB.serviceType}"/>
                                        </p:commandButton>
                                        <!--                                        <p:commandButton icon="pi pi-trash"-->
                                        <!--                                                         process="serviceTypeForm"-->
                                        <!--                                                         update="serviceTypeForm"-->
                                        <!--                                                         title="Supprimer"-->
                                        <!--                                                         styleClass="rounded-button ui-button mr-1"-->
                                        <!--                                                         onclick="PF('serviceTypeDeleteSidebar').show()">-->
                                        <!--                                            <f:setPropertyActionListener value="#{serviceType}"-->
                                        <!--                                                                         target="#{gestionUnServiceTypeMB.serviceType}"/>-->
                                        <!--                                        </p:commandButton>-->

                                    </p:column>

                                </p:dataTable>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </h:form>

        <p:sidebar widgetVar="editerServiceTypeSidebar"
                   styleClass="w-full lg:w-6 h-full overflow-y-auto"
                   position="right">
            <h4 class="font-bold"> Edition d'un service-type </h4>
            <p:divider styleClass="mt-0"/>
            <h:form id="editerServiceTypeForm">
                <div class="card">
                    <div class="ui-fluid formgrid grid">
                        <div class="field col-12 md:col-6">
                            <p:outputLabel for="@next" value="Libelle"/>
                            <p:inputText id="libelleServiceType"
                                         placeholder="Saisir le libelle "
                                         value="#{gestionUnServiceTypeMB.serviceType.libelle}"/>
                        </div>
                        <div class="field col-12 md:col-6">
                            <p:outputLabel for="@next" value="Age minimum"/>
                            <p:inputText id="ageMinimumServiceType"
                                         placeholder="Saisir l'age minimum "
                                         value="#{gestionUnServiceTypeMB.serviceType.ageMinimumLimite}"/></div>

                        <div class="field col-12 md:col-12">
                            <p:outputLabel for="@next" value="Description"/>
                            <p:inputTextarea id="descriptionServiceType" rows="5" maxlength="255"
                                             placeholder="Saisir la description"
                                             value="#{gestionUnServiceTypeMB.serviceType.description}"/>
                        </div>
                        <div class="field col-12 md:col-12">
                            <p:outputLabel for="@next">Logo</p:outputLabel>
                            <p:fileUpload id="serviceTypeUpdateSideLogo"
                                          mode="advanced" label="Choisir un logo"
                                          multiple="false"
                                          sizeLimit="102400" allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                          invalidSizeMessage="Maximum file size allowed is 100 KB"
                                          invalidFileMessage="only gif | jpg | jpeg | png is allowed"
                                          listener="#{cropUploaderBean.handleFileUpload}"/></div>
                        <div class="field col-10">
                            <div class="flex">
                                <p:commandButton value="Enregistrer"
                                                 action="#{gestionUnServiceTypeMB.creerServiceType()}"
                                                 update="serviceTypeForm, editerServiceTypeForm"
                                                 process="editerServiceTypeForm" icon="pi pi-check"
                                                 styleClass="w-auto mr-2"/>
                                <p:commandButton value="Annuler"
                                                 process="@this"
                                                 action="#{gestionUnServiceTypeMB.initServiceType()}"
                                                 update="editerServiceTypeForm"
                                                 icon="pi pi-times"
                                                 styleClass="w-auto"/>
                            </div>
                        </div>
                    </div>
                </div>
            </h:form>
        </p:sidebar>

        <p:sidebar widgetVar="modifierServiceTypeSidebar"
                   styleClass="w-full lg:w-6 h-full overflow-y-auto"
                   position="right">
            <h4 class="font-bold"> Modification d'un service-type </h4>
            <p:divider/>
            <p:tabView id="tabViewServiceTypeWeb">
                <p:tab title="Service-type">
                    <h:form id="modifierServiceTypeForm">
                        <div class="card">
                            <div class="ui-fluid formgrid grid">
                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Libelle"/>
                                    <p:inputText id="libelleServiceType1"
                                                 placeholder="Saisir le libelle "
                                                 value="#{gestionUnServiceTypeMB.serviceType.libelle}"/>
                                </div>
                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Age minimum"/>
                                    <p:inputText id="ageMinimumServiceType1"
                                                 placeholder="Saisir l'age minimum "
                                                 value="#{gestionUnServiceTypeMB.serviceType.ageMinimumLimite}"/>
                                </div>
                                <div class="field col-12 md:col-12">
                                    <p:outputLabel for="@next" value="Description"/>
                                    <p:inputTextarea id="descriptionServiceType1" rows="5" maxlength="255"
                                                     placeholder="Saisir la description"
                                                     value="#{gestionUnServiceTypeMB.serviceType.description}"/></div>
                                <div class="field col-12 md:col-12">
                                    <p:outputLabel for="@next">Logo</p:outputLabel>
                                    <p:fileUpload id="serviceTypeUpdateSideLogo1"
                                                  mode="advanced" label="Choisir un logo"
                                                  multiple="false"
                                                  sizeLimit="102400" allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                                  invalidSizeMessage="Maximum file size allowed is 100 KB"
                                                  invalidFileMessage="only gif | jpg | jpeg | png is allowed"
                                                  listener="#{cropUploaderBean.handleFileUpload}"/>
                                </div>
                                <div class="field col-10">
                                    <div class="flex">
                                        <p:commandButton value="Enregistrer"
                                                         action="#{gestionUnServiceTypeMB.modifierUnServiceType()}"
                                                         update="tabViewServiceTypeWeb:modifierServiceTypeForm"
                                                         process="modifierServiceTypeForm" icon="pi pi-check"
                                                         styleClass="w-auto mr-2"/>
                                        <p:commandButton value="Annuler"
                                                         process="@this"
                                                         action="#{gestionUnServiceTypeMB.initServiceType()}"
                                                         update="modifierServiceTypeForm"
                                                         icon="pi pi-times"
                                                         styleClass="w-auto"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </h:form>
                </p:tab>
                <p:tab title="Services web rattachés ">
                    <div class="card">
                        <h:form id="serviceWebTableForm">
                            <div class="col-12 mb-4">
                                <h5>Service web</h5>
                                <h6 class="my-3 "><i class="pi pi-info-circle"></i>
                                    Liste des services web (#{gestionUnServiceTypeMB.servicesWeb.size()})
                                </h6>
                                <p:dataTable id="idListeserviceweb" widgetVar="listeserviceweb"
                                             scrollable="true"
                                             scrollHeight="350px"
                                             var="serviceWeb"
                                             value="#{gestionUnServiceTypeMB.servicesWeb}"
                                             selection="#{gestionUnServiceTypeMB.serviceWeb}"
                                             emptyMessage="Aucun service web trouvé"
                                             lazy="true"
                                             rowKey="#{serviceWeb.ID}">
                                    <p:ajax event="rowSelect"
                                            update="tabViewServiceTypeWeb:serviceWebCreateForm"/>
                                    <p:column headerText="Titre">
                                        <h:outputText value="#{serviceWeb.titre}"/>
                                    </p:column>
                                    <p:column headerText="Version">
                                        <h:outputText value="#{serviceWeb.version}"/>
                                    </p:column>
                                    <p:column headerText="Adresse IP et Port">
                                        <h:outputText value="#{serviceWeb.adresseIpEtPortLocalisation}"/>
                                    </p:column>
                                    <p:column headerText="Type de service web">
                                        <h:outputText value="#{serviceWeb.typeServiceWeb}"/>
                                    </p:column>
                                </p:dataTable>
                            </div>

                        </h:form>

                        <h:form id="serviceWebCreateForm">
                            <p:divider/>
                            <h6 class="my-3 ">
                                <i class="pi pi-info-circle"></i>
                                Pour un nouveau service type, renseigner les informations ci-dessous
                            </h6>
                            <div class="ui-fluid formgrid grid">
                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Titre"/>
                                    <p:inputText id="firstname1" required="true"
                                                 placeholder="Saisir le titre"
                                                 value="#{gestionUnServiceTypeMB.serviceWeb.titre}"/>
                                </div>
                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Type de service web"/>
                                    <p:selectOneMenu id="idTypeweb" required="true"
                                                     requiredMessage="Veuillez renseigner le type de service web"
                                                     value="#{gestionUnServiceTypeMB.serviceWeb.typeServiceWeb}">
                                        <f:selectItem itemLabel="Selectionnez un type"
                                                      itemValue="#{gestionUnServiceTypeMB.typeServiceWeb}"/>
                                        <f:selectItems value="#{gestionUnServiceTypeMB.typeServiceWebs}"/>
                                    </p:selectOneMenu>
                                </div>

                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Adresse de localisation"/>
                                    <p:inputText id="adress4" placeholder="Saisir l'adresse de localisation"
                                                 value="#{gestionUnServiceTypeMB.serviceWeb.adresseIpEtPortLocalisation}"
                                                 required="true"
                                                 requiredMessage="Veuillez renseigner l'adresse de localisation"/>
                                </div>

                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Nom du contact"/>
                                    <p:inputText id="adress" placeholder="Saisir le nom du contact"
                                                 value="#{gestionUnServiceTypeMB.serviceWeb.nomContact}"/>
                                </div>
                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="url du contact"/>
                                    <p:inputText id="adres7" placeholder="Saisir l'url du contact"
                                                 value="#{gestionUnServiceTypeMB.serviceWeb.urlContact}"/>
                                </div>
                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Email du contact"/>
                                    <p:inputText id="adress8" placeholder="Saisir l'email du contact"
                                                 value="#{gestionUnServiceTypeMB.serviceWeb.emailContact}"/>
                                </div>
                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Nom de la licence"/>
                                    <p:inputText id="adress9" placeholder="Saisir le nom de la licence"
                                                 value="#{gestionUnServiceTypeMB.serviceWeb.nomLicence}"/>
                                </div>
                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Url de la licence"/>
                                    <p:inputText id="adress11" placeholder="Saisir l'url de la licence"
                                                 value="#{gestionUnServiceTypeMB.serviceWeb.urlLicence}"/>
                                </div>
                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Version"/>
                                    <p:inputText id="adress12" placeholder="Saisir la version"
                                                 value="#{gestionUnServiceTypeMB.serviceWeb.version}"/>
                                </div>

                                <div class="field col-12 md:col-6">
                                    <p:outputLabel for="@next" value="Chemin de localisation"/>
                                    <p:inputText id="adress5" placeholder="Saisir le chemin de localisation"
                                                 value="#{gestionUnServiceTypeMB.serviceWeb.cheminLocalisation}"/>
                                </div>
                                <!--                            <div class="field col-12 md:col-6">-->
                                <!--                                <p:outputLabel for="@next" value="Libelle"/>-->
                                <!--                                <p:inputText id="adress6" value="#{gestionUnServiceTypeMB.serviceWeb.libelle}"/>-->
                                <!--                            </div>-->
                                <div class="field col-12 md:col-12">
                                    <p:outputLabel for="@next" value="Description"/>
                                    <p:inputTextarea rows="5" maxlength="255"
                                                     value="#{gestionUnServiceTypeMB.serviceWeb.description}"
                                                     placeholder="Saisir une description..."/>
                                </div>
                            </div>

                            <div class="ui-fluid formgrid grid">
                                <p:commandButton icon="pi pi-save"
                                                 action="#{gestionUnServiceTypeMB.creerUnServiceWeb()}"
                                                 update="tabViewServiceTypeWeb:serviceWebTableForm,tabViewServiceTypeWeb:serviceWebCreateForm"
                                                 process="serviceWebCreateForm"
                                                 value="Enregistrer" styleClass="w-auto mr-2"/>
                                <p:commandButton icon="pi pi-trash"
                                                 disabled="#{gestionUnServiceTypeMB.serviceWeb.ID == null}"
                                                 action="#{gestionUnServiceTypeMB.supprimerUnServicesWeb()}"
                                                 update="tabViewServiceTypeWeb:serviceWebTableForm"
                                                 process="@this"
                                                 value="Supprimer" styleClass="w-auto mr-2"/>
                                <p:commandButton icon="pi pi-times" action="#{gestionUnServiceTypeMB.initServiceWeb()}"
                                                 update="tabViewServiceTypeWeb:serviceWebTableForm,serviceWebCreateForm"
                                                 process="serviceWebCreateForm"
                                                 value="Annuler" styleClass="w-auto mr-2"/>
                            </div>
                        </h:form>
                    </div>
                </p:tab>
            </p:tabView>
        </p:sidebar>

        <p:sidebar widgetVar="activateServiceTypeSidebar"
                   styleClass="w-full lg:w-6 h-full overflow-y-auto" position="right">
            <h4 class="font-bold ">
                Activation / Désactivation d'un service type </h4>
            <p:divider styleClass="mb-2"/>
            <h:form id="activateServiceTypeSidebarForm">
                <div class="grid">
                    <div class="col-12">
                        <div class="ui-fluid formgrid grid">
                            <div class="field col-12 md:col-12">
                                <p:outputLabel for="@next" value="Faire une annotation"/>
                                <p:inputTextarea id="activateServiceTypeSideAnnotation"
                                                 required="true" requiredMessage="Veuillez saisir un commentaire"
                                                 value="#{gestionUnServiceTypeMB.annotation.commentaire}"
                                                 placeholder="Saisir un commentaire..." rows="5"
                                                 maxlength="255"/>
                            </div>

                            <div class="field col-12">
                                <div class="flex">
                                    <p:commandButton value="Activer"
                                                     disabled="#{gestionUnServiceTypeMB.serviceType.statutServiceType == 'ACTIF'}"
                                                     update="serviceTypeForm,activateServiceTypeSidebarForm"
                                                     action="#{gestionUnServiceTypeMB.activerUnServiceType()}"
                                                     process="activateServiceTypeSidebarForm"
                                                     icon="pi pi-save" styleClass="w-auto mr-2"/>

                                    <p:commandButton value="Désactiver"
                                                     disabled="#{gestionUnServiceTypeMB.serviceType.statutServiceType == 'INACTIF'}"
                                                     update="serviceTypeForm,activateServiceTypeSidebarForm"
                                                     action="#{gestionUnServiceTypeMB.desactiverUnServiceType()}"
                                                     process="activateServiceTypeSidebarForm"
                                                     icon="pi pi-save" styleClass="w-auto mr-2"/>
                                    <p:commandButton value="Annuler" process="@this"
                                                     action="#{gestionUnServiceTypeMB.initAnnotation()}"
                                                     update="activateServiceTypeSidebarForm,serviceTypeForm"
                                                     icon="pi pi-times" styleClass="w-auto mr-2"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </h:form>
        </p:sidebar>
        <p:sidebar styleClass="w-full lg:w-6 h-full overflow-y-auto"
                   modal="true"
                   widgetVar="serviceTypeDeleteSidebar"
                   position="right">
            <h:form id="deleteServiceTypeSidebarForm">
                <div class="grid">
                    <div class="col-12">
                        <h4 class="font-bold ">Suppression d'un service-type </h4>
                        <p:divider styleClass="mb-2"/>
                        <div class="ui-fluid formgrid grid">
                            <div class="field col-12 md:col-12">
                                <p:outputLabel for="@next" value="Faire une annotation"/>
                                <p:inputTextarea id="deleteServiceTypeSideAnnotation"
                                                 required="true" maxlength="255"
                                                 requiredMessage="Veuillez saisir un commentaire"
                                                 value="#{gestionUnServiceTypeMB.annotation.commentaire}"
                                                 placeholder="Saisir un commentaire..." rows="5"
                                />

                            </div>
                            <div class="field col-12">
                                <div class="flex">
                                    <p:commandButton value="Supprimer" process="deleteServiceTypeSidebarForm"
                                                     update="serviceTypeForm,deleteServiceTypeSidebarForm"
                                                     action="#{gestionUnServiceTypeMB.supprimerUnServiceType()}"
                                                     icon="pi pi-trash"
                                                     styleClass="w-auto mr-2">
                                    </p:commandButton>
                                    <p:commandButton value="Annuler" process="@this"
                                                     action="#{gestionUnServiceTypeMB.initServiceType()}"
                                                     update="deleteServiceTypeSidebarForm"
                                                     icon="pi pi-times" styleClass="w-auto "/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </h:form>
        </p:sidebar>
    </ui:define>
</ui:composition>
