<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml">

    <ui:define name="title">Désinscription du contributeur</ui:define>
    <ui:define name="viewname">
        <li>CONTRIBUTEUR</li>
        <li>
            <i class="pi pi-chevron-right"></i>
        </li>
        <li>
            <p:link outcome="/desinscription-contributeur/desinscrire-contributeur"> DESINSCRIPTION D'UN CONTRIBUTEUR </p:link>
        </li>
    </ui:define>
    <ui:define name="content">

        <div class="grid">
            <div class="col flex align-items-center justify-content-center md:px-7">
                <div class="card col-12 md:col-8 md:pl-5">
                    <div class="grid ">
                        <div class="col-12">
                            <h3 class="font-bold mb-2">Désinscription d'un contributeur</h3>
                            <h6 class="mb-3">
                                <i class="pi pi-info-circle"> </i>
                                Sélectionnez les raisons de votre désinscription.
                            </h6>
                            <h:form id="DemandeDesinscriptionForm">
                                <div class="ui-fluid formgrid grid ">
                                    <div class="field col-12">
                                        <p:outputLabel for="@next" value="Raisons-types de désabonnement"/>
                                        <p:selectCheckboxMenu id="RaisonTypeDesabonnements"
                                                              converter="#{entityConverter}"
                                                              filter="true" filterMatchMode="startsWith"
                                                              label="raisons-types de desabonnement" multiple="true"
                                                              emptyLabel="Sélectionner la(es) raison(s)-type(s) de désabonnement "
                                                              updateLabel="true"
                                                              scrollHeight="150"
                                                              value="#{desinscriptionDeContributeurMB.listeRaisonTypeDesabonnementSelectionne}">
                                            <f:selectItems
                                                    value="#{desinscriptionDeContributeurMB.listeRaisonTypeDesabonnement}"
                                                    var="raisonTypeDesabonnement"
                                                    itemLabel="#{raisonTypeDesabonnement.libelle}"
                                                    itemValue="#{raisonTypeDesabonnement}"/>
                                        </p:selectCheckboxMenu>
                                    </div>
                                    <div class="field col-12 ">
                                        <p:outputLabel for="@next" value="Faire un commentaire "/>
                                        <p:inputTextarea rows="5" maxlength="255"
                                                         value="#{desinscriptionDeContributeurMB.annotation.commentaire}"/>
                                    </div>
                                    <div class="field col-12 ">
                                        <p:commandLink id="lnk" value="Générer Otp" type="button"
                                                       styleClass="font-bold" onclick="PF('confirmerCode').show()">
                                        </p:commandLink>
                                    </div>
                                    <div class="flex justify-content-start flex-wrap mt-2">

                                        <p:commandButton value="Valider" id="btnValiderDemandeDesinscription"
                                                         process="DemandeDesinscriptionForm"
                                                         action="#{desinscriptionDeContributeurMB.desinscrireLeContributeur()}"
                                                         disabled="#{!desinscriptionDeContributeurMB.isValideOtp}"
                                                         update="DemandeDesinscriptionForm" styleClass="mr-2 w-auto"
                                                         icon="pi pi-check">
                                        </p:commandButton>
                                        <p:commandButton value="Annuler"
                                                         process="@this"
                                                         action="#{desinscriptionDeContributeurMB.resetFormDemandeDesinscription()}"
                                                         update="DemandeDesinscriptionForm"
                                                         styleClass="w-auto" icon="pi pi-times">
                                        </p:commandButton>
                                    </div>
                                </div>
                            </h:form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <h:form id="formValidationOtp">
            <div class="ui-fluid formgrid grid ">
                <div class="flex justify-content-start flex-wrap mt-2">
                    <p:dialog header="Confirmation du code" widgetVar="confirmerCode" minHeight="50"
                              width="350" positionType="fixed"
                              showEffect="fade" closeOnEscape="false">
                        <div class="field col-12">
                            <p:outputLabel for="@next" value="Entrez le code reçu"/>
                            <p:inputText id="desincrireCode"
                                         value="#{desinscriptionDeContributeurMB.otp.code}"
                            />
                        </div>
                        <div class="field col-12">
                            <p:commandButton value="Confirmer"
                                             action="#{desinscriptionDeContributeurMB.validerUnOtp()}"
                                             process="formValidationOtp"
                                             update="formValidationOtp" styleClass="mr-2 w-auto"
                                             icon="pi pi-check">
                            </p:commandButton>
                        </div>
                    </p:dialog>
                </div>
            </div>
        </h:form>
    </ui:define>
</ui:composition>
